function H_part = sur_fmm_Hsum(j, ns, bie_f, posint, eps, srcinfo, pg, targ, pgt)

ntarg = size(targ,2);
H_part = zeros(1, ntarg);

ns_part = size(posint,2);
for i = 1:3
    v_mx = zeros(size(posint));
    
    if i == j
        srcinfo.charges = bie_f(i).*ones(1, ns_part);
    else
        srcinfo.charges = zeros(1,ns_part);
    end
    
    v_mx = bie_f.*posint;
    srcinfo.dipoles = -v_mx;
    
    H_11 = lfmm3d(eps, srcinfo, pg, targ, pgt);
    H_part = H_part + H_11.pottarg;
end

end